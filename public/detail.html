<!DOCTYPE html>
<html lang="zh-CN">

<head>
  <meta charset="UTF-8">
  <meta name="viewport"
    content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
  <title>导航详情 - 水果导航</title>
  
  <!-- 基础路径配置 -->
  <script>
    // 自动检测基础路径（兼容直接访问HTML文件的场景）
    window.BASE_PATH = (function() {
      const pathname = window.location.pathname || '';
      
      if (!pathname || pathname === '/' || pathname === '') {
        return '';
      }
      
      const hasExtension = /\.[^/.]+$/.test(pathname);
      if (hasExtension) {
        const dir = pathname.substring(0, pathname.lastIndexOf('/'));
        return dir || '';
      }
      
      return pathname.endsWith('/') ? pathname.slice(0, -1) : pathname;
    })();
    
    window.getBasePath = function(path) {
      if (!path) return window.BASE_PATH || '';
      if (path.startsWith('http://') || path.startsWith('https://') || path.startsWith('//')) {
        return path;
      }
      const base = window.BASE_PATH || '';
      const cleanPath = path.startsWith('/') ? path : '/' + path;
      return base + cleanPath;
    };
  </script>
  
  <!-- PWA Meta Tags -->
  <meta name="application-name" content="水果导航">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="apple-mobile-web-app-title" content="水果导航">
  <meta name="description" content="导航详情页">
  <meta name="mobile-web-app-capable" content="yes">
  <meta name="theme-color" content="#ff0066">
  
  <!-- Icons -->
  <link rel="icon" type="image/x-icon" href="img/favicon.ico">
  <link rel="icon" type="image/png" sizes="32x32" href="img/icons/icon-72x72.png">
  <link rel="apple-touch-icon" sizes="180x180" href="img/icons/icon-192x192.png">
  
  <!-- Stylesheets -->
  <link rel="stylesheet" href="css/style.css">
  <link rel="stylesheet" href="css/detail.css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css">
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
</head>

<body>
  <!-- 移动端顶部导航栏 -->
  <header class="mobile-header">
    <div class="mobile-nav">
      <button class="hamburger-btn" id="hamburger-btn" aria-label="打开菜单">
        <span></span>
        <span></span>
        <span></span>
      </button>
      <div class="mobile-logo">
        <img src="./img/avatar.svg" alt="logo" srcset="">
        <span>水果导航</span>
      </div>
      <div class="mobile-actions">
        <button id="review-btn-mobile" class="review-button mobile-action-btn" title="游客申请" style="display: none;">
          <i class="bi bi-clock-history"></i>
        </button>
        <button id="bitable-manage-btn-mobile" class="mobile-action-btn" title="多维表格管理" style="display: none;">
          <i class="bi bi-table"></i>
        </button>
        <button id="login-btn-mobile" class="mobile-action-btn login-button" title="登录">
          <i class="bi bi-lock"></i>
        </button>
        <button id="theme-toggle-btn" class="mobile-action-btn theme-toggle-button" title="切换暗黑模式">
          <i class="bi bi-moon"></i>
        </button>
      </div>
    </div>
  </header>

  <!-- 顶部导航栏（桌面端） -->
  <header class="top-header desktop-only">
    <div class="header-content">
      <div class="header-left">
        <div class="header-logo">
          <a href="index.html" style="display: flex; align-items: center; gap: 12px; text-decoration: none; color: inherit;">
            <img src="./img/avatar.svg" alt="logo">
            <span>水果导航</span>
          </a>
        </div>
        <nav class="header-nav">
          <div class="nav-dropdown">
            <a href="#" class="nav-link dropdown-trigger">
              <span>专业导航</span>
              <i class="bi bi-chevron-down"></i>
            </a>
            <div class="dropdown-menu" id="bitable-dropdown-menu">
              <div class="dropdown-loading">
                <i class="bi bi-hourglass-split"></i>
                <span>加载中...</span>
              </div>
            </div>
          </div>
          <a href="index.html" class="nav-link">首页</a>
          <a href="#" class="nav-link">在线工具</a>
          <a href="#" class="nav-link">AI资源集</a>
          <a href="#" class="nav-link">关于我们</a>
        </nav>
      </div>
      <div class="header-right">
        <button id="review-btn-desktop" class="review-button header-action-btn" title="游客申请" style="display: none;">
          <i class="bi bi-clock-history"></i>
          <span id="review-status-text">游客申请</span>
        </button>
        <button id="bitable-manage-btn-desktop" class="header-action-btn" title="多维表格管理" style="display: none;">
          <i class="bi bi-table"></i>
          <span>表格管理</span>
        </button>
        <button id="login-btn-desktop" class="header-action-btn login-button" title="登录">
          <i class="bi bi-lock"></i>
          <span id="login-status-text">登录</span>
        </button>
        <button id="desktop-theme-toggle-btn" class="header-action-btn theme-toggle-button" title="切换暗黑模式">
          <i class="bi bi-moon"></i>
        </button>
      </div>
    </div>
  </header>

  <!-- 移动端遮罩层 -->
  <div class="mobile-overlay" id="mobile-overlay"></div>

  <!-- 主内容区 -->
  <div class="container">
    <!-- 左侧侧边栏 -->
    <aside class="sidebar" id="sidebar">
      <nav class="nav-menu">
        <ul id="category-menu">
          <li class="active" data-category="all"><i class="bi bi-house-door"></i> 全部</li>
          <!-- 动态生成的分类菜单项 --> 
        </ul>

        
        <!-- 皮肤选择器 -->
        <div class="skin-selector" id="skin-selector">
          <div class="current-skin">
            <div class="current-skin-preview">
              <i class="bi bi-stars current-skin-icon"></i>
            </div>
            <span class="current-skin-name">霓虹风格</span>
            <button class="skin-expand-btn">
              <i class="bi bi-chevron-down"></i>
            </button>
          </div>
          
          <div class="skin-options">
            <div class="skin-grid">
              <div class="skin-option active" data-skin="neon">
                <div class="skin-colors">
                  <div class="color-dot primary"></div>
                  <div class="color-dot secondary"></div>
                  <div class="color-dot accent"></div>
                </div>
                <span class="skin-label">霓虹风格</span>
              </div>
              
              <div class="skin-option" data-skin="ocean">
                <div class="skin-colors">
                  <div class="color-dot primary"></div>
                  <div class="color-dot secondary"></div>
                  <div class="color-dot accent"></div>
                </div>
                <span class="skin-label">海洋蓝调</span>
              </div>
              
              <div class="skin-option" data-skin="forest">
                <div class="skin-colors">
                  <div class="color-dot primary"></div>
                  <div class="color-dot secondary"></div>
                  <div class="color-dot accent"></div>
                </div>
                <span class="skin-label">森林绿意</span>
              </div>
              
              <div class="skin-option" data-skin="sunset">
                <div class="skin-colors">
                  <div class="color-dot primary"></div>
                  <div class="color-dot secondary"></div>
                  <div class="color-dot accent"></div>
                </div>
                <span class="skin-label">日落橙黄</span>
              </div>
              
              <div class="skin-option" data-skin="purple">
                <div class="skin-colors">
                  <div class="color-dot primary"></div>
                  <div class="color-dot secondary"></div>
                  <div class="color-dot accent"></div>
                </div>
                <span class="skin-label">优雅紫色</span>
              </div>
              
              <div class="skin-option" data-skin="classic">
                <div class="skin-colors">
                  <div class="color-dot primary"></div>
                  <div class="color-dot secondary"></div>
                  <div class="color-dot accent"></div>
                </div>
                <span class="skin-label">经典灰调</span>
              </div>
            </div>
            
            <div class="skin-mode-toggle">
              <i class="bi bi-moon"></i>
              <span>暗黑模式</span>
            </div>
          </div>
        </div>
      </nav>
    </aside>

    <!-- 详情页主内容区 -->
    <div class="detail-container">
      <div class="detail-main">
      <!-- 1. 导航数据介绍和直链详情卡片区 -->
      <section class="detail-intro-card">
        <div class="intro-card-content">
          <div class="intro-left">
            <div class="intro-icon">
              <img id="detail-icon" src="" alt="" onerror="this.style.display='none'; this.nextElementSibling.style.display='flex';">
            </div>
            <div class="intro-info">
              <h1 id="detail-title" class="intro-title">网站名称</h1>
              <p id="detail-description" class="intro-description">网站描述信息</p>
              <div class="intro-tags" id="detail-tags">
                <!-- 动态生成的标签 -->
              </div>
            </div>
          </div>
          <div class="intro-right">
            <a id="detail-direct-link" href="#" target="_blank" class="direct-link-btn">
              <span>链接直达</span>
              <i class="bi bi-arrow-right"></i>
            </a>
            <button class="mobile-view-btn" title="手机查看">
              <i class="bi bi-phone"></i>
              <span>手机查看</span>
            </button>
            <button class="info-btn" title="详细信息">
              <i class="bi bi-info-circle"></i>
            </button>
          </div>
        </div>
      </section>

      <!-- 2. 走马灯广告卡片区 -->
      <section class="carousel-ads-section">
        <div class="carousel-ads-container" id="carousel-ads">
          <!-- 动态生成的广告卡片 -->
        </div>
      </section>

      <!-- 3. 网站详细介绍区域 -->
      <section class="detail-description-section">
        <div class="description-content">
          <h2 class="section-title">网站详细介绍</h2>
          <div id="detail-full-description" class="full-description" data-description-source="">
            <!-- 动态加载的详细介绍内容 -->
          </div>
        </div>
      </section>

      <!-- 4. 相关导航链接区域 -->
      <section class="related-nav-section">
        <h2 class="section-title">相关导航</h2>
        <div class="related-nav-grid" id="related-nav-grid">
          <!-- 动态生成的相关导航卡片 -->
        </div>
      </section>

      <!-- 5. 底部广告区 -->
      <section class="bottom-ad-section">
        <div class="ad-banner" id="bottom-ad">
          <!-- 动态生成的广告内容 -->
        </div>
      </section>

      <!-- 6. 游客反馈区域 -->
      <section class="comment-section">
        <h2 class="section-title">游客反馈</h2>
        <div class="comment-form">
          <div class="comment-avatar">
            <i class="bi bi-person-circle"></i>
          </div>
          <div class="comment-input-wrapper">
            <textarea id="comment-content" class="comment-textarea" placeholder="输入评论内容..."></textarea>
            <div class="comment-meta">
              <input type="text" id="comment-nickname" class="comment-input" placeholder="昵称">
              <input type="email" id="comment-email" class="comment-input" placeholder="邮箱">
              <button id="submit-comment-btn" class="comment-submit-btn">发表评论</button>
            </div>
          </div>
        </div>
        <div class="comments-list" id="comments-list">
          <div class="no-comments">
            <p>暂无评论...</p>
          </div>
        </div>
      </section>
    </div>

      <!-- 右侧广告区（sticky） -->
      <aside class="detail-sidebar">
        <div class="sidebar-ad" id="sidebar-ad">
          <!-- 动态生成的侧边栏广告 -->
        </div>
      </aside>
    </div>
  </div>

  <!-- 右侧浮动操作按钮 -->
  <div class="floating-actions desktop-only">
    <button class="floating-btn" id="scroll-top-btn" title="返回顶部">
      <i class="bi bi-arrow-up"></i>
    </button>
    <button class="floating-btn" id="help-btn" title="帮助">
      <i class="bi bi-question-circle"></i>
    </button>
    <button class="floating-btn" id="docs-btn" title="文档">
      <i class="bi bi-file-text"></i>
    </button>
    <button class="floating-btn" id="home-btn" title="首页">
      <i class="bi bi-house"></i>
    </button>
    <button class="floating-btn" id="floating-theme-btn" title="切换暗黑模式">
      <i class="bi bi-moon"></i>
    </button>
    <div class="wechat-qr-container">
      <button class="floating-btn" id="wechat-btn" title="微信二维码">
        <i class="bi bi-wechat"></i>
      </button>
      <div class="wechat-qr-popup" id="wechat-qr-popup">
        <div class="qr-code-wrapper">
          <img src="./img/wechat-qr.png" alt="微信二维码" class="qr-code-image" onerror="this.style.display='none'; this.nextElementSibling.style.display='block';">
          <div class="qr-code-placeholder" style="display: none;">
            <i class="bi bi-qr-code-scan" style="font-size: 80px; color: #999;"></i>
            <p style="margin-top: 10px; color: #999; font-size: 14px;">请添加微信二维码图片<br>路径: ./img/wechat-qr.png</p>
          </div>
        </div>
        <div class="qr-arrow"></div>
      </div>
    </div>
    <div class="feishu-qr-container">
      <button class="floating-btn" id="feishu-btn" title="飞书二维码">
        <i class="bi bi-chat-dots"></i>
      </button>
      <div class="feishu-qr-popup" id="feishu-qr-popup">
        <div class="qr-code-wrapper">
          <img src="./img/feishu-qr.png" alt="飞书二维码" class="qr-code-image" onerror="this.style.display='none'; this.nextElementSibling.style.display='block';">
          <div class="qr-code-placeholder" style="display: none;">
            <i class="bi bi-qr-code-scan" style="font-size: 80px; color: #999;"></i>
            <p style="margin-top: 10px; color: #999; font-size: 14px;">请添加飞书二维码图片<br>路径: ./img/feishu-qr.png</p>
          </div>
        </div>
        <div class="qr-arrow"></div>
      </div>
    </div>
    <button class="floating-btn" id="more-btn" title="更多">
      <i class="bi bi-three-dots"></i>
    </button>
  </div>

  <!-- 登录验证模态框 -->
  <div id="login-modal" class="modal">
    <div class="modal-overlay"></div>
    <div class="modal-content">
      <div class="modal-header">
        <h2>身份验证</h2>
        <button id="close-login-modal-btn" class="close-modal-btn" aria-label="关闭">
          <i class="bi bi-x"></i>
        </button>
      </div>
      
      <div class="modal-body">
        <form id="login-form">
          <div class="form-group">
            <label for="login-password">请输入密码 *</label>
            <input type="password" id="login-password" name="login-password" placeholder="请输入管理员密码" autocomplete="current-password">
            <div class="error-message" id="login-error"></div>
          </div>
        </form>
      </div>
      
      <div class="modal-footer">
        <button id="cancel-login-btn" class="cancel-btn">取消</button>
        <button id="submit-login-btn" class="save-btn">登录</button>
      </div>
    </div>
  </div>

  <!-- 管理员审核模态框 -->
  <div id="admin-review-modal" class="modal">
    <div class="modal-overlay"></div>
    <div class="modal-content admin-review-modal-content">
      <div class="modal-header">
        <h2>待审核链接管理</h2>
        <button id="close-admin-review-modal-btn" class="close-modal-btn" aria-label="关闭">
          <i class="bi bi-x"></i>
        </button>
      </div>
      
      <div class="modal-body admin-review-modal-body">
        <div id="admin-pending-links-container">
          <div class="loading-state">
            <i class="bi bi-hourglass-split"></i>
            <p>加载中...</p>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- 多维表格管理模态框 -->
  <div id="bitable-manage-modal" class="modal">
    <div class="modal-overlay"></div>
    <div class="modal-content admin-review-modal-content">
      <div class="modal-header">
        <h2>多维表格管理</h2>
        <button id="close-bitable-manage-modal-btn" class="close-modal-btn" aria-label="关闭">
          <i class="bi bi-x"></i>
        </button>
      </div>
      
      <div class="modal-body admin-review-modal-body">
        <div class="bitable-manage-toolbar">
          <button id="create-bitable-btn" class="save-btn">
            <i class="bi bi-plus-circle"></i>
            <span>新建表格</span>
          </button>
        </div>
        
        <div id="bitable-list-container">
          <div class="loading-state">
            <i class="bi bi-hourglass-split"></i>
            <p>加载中...</p>
          </div>
        </div>
        
        <div class="pagination" id="bitable-pagination" style="display: none;">
          <button class="pagination-btn" id="bitable-prev-btn" disabled>
            <i class="bi bi-chevron-left"></i>
            <span>上一页</span>
          </button>
          <span class="pagination-info" id="bitable-pagination-info"></span>
          <button class="pagination-btn" id="bitable-next-btn" disabled>
            <span>下一页</span>
            <i class="bi bi-chevron-right"></i>
          </button>
        </div>
      </div>
    </div>
  </div>

  <!-- 创建多维表格模态框 -->
  <div id="create-bitable-modal" class="modal">
    <div class="modal-overlay"></div>
    <div class="modal-content">
      <div class="modal-header">
        <h2>创建多维表格</h2>
        <button id="close-create-bitable-modal-btn" class="close-modal-btn" aria-label="关闭">
          <i class="bi bi-x"></i>
        </button>
      </div>
      
      <div class="modal-body">
        <form id="create-bitable-form">
          <div class="form-group">
            <label for="bitable-name">表格名称 *</label>
            <input type="text" id="bitable-name" name="bitable-name" placeholder="请输入表格名称" maxlength="100" required>
            <div class="error-message" id="bitable-name-error"></div>
          </div>
          
          <div class="form-group">
            <label for="bitable-description">描述 (可选)</label>
            <textarea id="bitable-description" name="bitable-description" placeholder="请输入表格描述" rows="3" maxlength="500"></textarea>
            <div class="error-message" id="bitable-description-error"></div>
          </div>
        </form>
      </div>
      
      <div class="modal-footer">
        <button id="cancel-create-bitable-btn" class="cancel-btn">取消</button>
        <button id="submit-create-bitable-btn" class="save-btn">创建</button>
      </div>
    </div>
  </div>

  <script src="js/app.js"></script>
  <script src="js/modules/detail-page.js"></script>
</body>
</html>

